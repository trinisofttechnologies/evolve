/*
 * History API JavaScript Library v4.0.0
 *
 * Support: IE6+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 19.05.13 22:46
 */
(function(e){var h=!0,j=null,n=!1;function K(){}function i(a,b,c){if(a&&!b)var b=i(),c=b.e,e=b.h,a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?e+a:a:e+"//"+b.g+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b.f+a:c.replace(/[^\/]+$/g,"")+a);else if(a=b?a:d.href,!q||c)a=a.replace(/^[^#]*/,"")||"#",a=d.protocol+"//"+d.host+m.basepath+a.replace(RegExp("^#[/]?(?:"+m.type+")?"),"");P.href=a;var a=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(P.href),b=
a[2]+(a[3]?":"+a[3]:""),c=a[4]||"/",e=a[5]||"",g="#"===a[6]?"":a[6]||"",o=c+e+g,u=c.replace(RegExp("^"+m.basepath,"i"),m.type)+e;return{a:a[1]+"//"+b+o,h:a[1],g:b,i:a[2],k:a[3]||"",e:c,f:e,b:g,c:o,j:u,d:u+g}}function Z(a){var b="";if(E)b+=E.getItem(F);else{var c=l.cookie.split(F+"=");1<c.length&&(b+=c.pop().split(";").shift()||"null")}try{r=a.parse(b)||{}}catch(e){r={}}v(w+"unload",function(){if(E)E.setItem(F,a.stringify(r));else{var b={};if(b[d.href]=f.state)l.cookie=F+"="+a.stringify(b)}},n)}function x(a,
b,c,k){var c=c||{set:K},g=!c.set,d=!c.get,u={configurable:h,set:function(){g=1},get:function(){d=1}};try{C(a,b,u),a[b]=a[b],C(a,b,c)}catch(fa){}if(!g||!d)if(a.__defineGetter__&&(a.__defineGetter__(b,u.get),a.__defineSetter__(b,u.set),a[b]=a[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)),(!g||!d)&&a===e){try{var $=a[b];a[b]=j}catch(ga){}if("execScript"in e)e.execScript("Public "+b,"VBScript");else try{C(a,b,{value:K})}catch(i){}a[b]=$}else if(!g||!d)try{try{var y=G.create(a);
C(G.getPrototypeOf(y)===a?y:a,b,c);for(var f in a)"function"===typeof a[f]&&(y[f]=a[f].bind(a));try{k.call(y,y,a)}catch(l){}a=y}catch(m){C(a.constructor.prototype,b,c)}}catch(p){return n}return a}function aa(a,b,c){c=c||{};a=a===L?d:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function H(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),d=z[c];if(d){b="string"===typeof a?b:a;if(b.target==j)for(var g=["target","currentTarget","srcElement","type"];a=
g.pop();)b=x(b,a,{get:"type"===a?function(){return c}:function(){return e}});(("popstate"===c?e.onpopstate:e.onhashchange)||K).call(e,b);for(var g=0,f=d.length;g<f;g++)d[g].call(e,b);return h}return ba(a,b)}function Q(){var a=l.createEvent?l.createEvent("Event"):l.createEventObject();a.initEvent?a.initEvent("popstate",n,n):a.type="popstate";a.state=f.state;H(a)}function s(a,b,c,e){q||(b=i(b),b.c!==i().c&&(A=e,c?d.replace("#"+b.d):d.hash=b.d));!I&&a&&(r[d.href]=a);D=n}function M(a){if(A){R!==d.href&&
Q();var a=a||e.event,b=i(A,h),c=i();a.oldURL||(a.oldURL=b.a,a.newURL=c.a);b.b!==c.b&&H(a)}A=d.href}function S(a){setTimeout(function(){v("popstate",function(a){R=d.href;I||(a=x(a,"state",{get:function(){return f.state}}));H(a)},n)},0);!q&&a!==h&&f.location&&(T(f.location.hash),D&&(D=n,Q()))}function ca(a){var a=a||e.event,b=a.target||a.srcElement,c="defaultPrevented"in a?a.defaultPrevented:a.returnValue===n;b&&"A"===b.nodeName&&!c&&(c=i(),b=i(b.getAttribute("href",2)),c.a.split("#").shift()===b.a.split("#").shift()&&
(c.b!==b.b&&(f.location.hash=b.b),T(b.b),a.preventDefault?a.preventDefault():a.returnValue=n))}function T(a){var b=l.getElementById(a=(a||"").replace(/^#/,""));b&&b.id===a&&"A"===b.nodeName&&(a=b.getBoundingClientRect(),e.scrollTo(J.scrollLeft||0,a.top+(J.scrollTop||0)-(J.clientTop||0)))}function da(){function a(a){var b=[],d="VBHistoryClass"+(new Date).getTime()+c++,g=["Class "+d],f;for(f in a)if(a.hasOwnProperty(f)){var k=a[f];k&&(k.get||k.set)?(k.get&&g.push("Public "+("_"===f?"Default ":"")+"Property Get ["+
f+"]","Call VBCVal([(accessors)].["+f+"].get.call(me),["+f+"])","End Property"),k.set&&g.push("Public Property Let ["+f+"](val)",k="Call [(accessors)].["+f+"].set.call(me,val)\nEnd Property","Public Property Set ["+f+"](val)",k)):(b.push(f),g.push("Public ["+f+"]"))}g.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function");e.execScript(g.join("\n"),"VBScript");e[d+"FactoryJS"]=
function(){return a};d=e[d+"Factory"]();for(g=0;g<b.length;g++)d[b[g]]=a[b[g]];return d}function b(a){var b=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.test(a)?'"'+a.replace(b,function(a){return a in c?c[a]:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}var c=e.eval&&eval("/*@cc_on 1;@*/");if(c&&
!(7<+(/msie (\d+)/i.exec(navigator.userAgent)||[,8])[1])){var k=x,g=i().a,o=l.createElement("iframe");o.src="javascript:true;";o=J.firstChild.appendChild(o).contentWindow;e.execScript("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");t={_:{get:L.toString}};f={back:p.back,forward:p.forward,go:p.go,emulate:j,_:{get:function(){return"[object History]"}}};B={parse:function(a){try{return(new Function("","return "+a))()}catch(b){return j}},stringify:function(a){var c=
(typeof a).charCodeAt(2);if(114===c)a=b(a);else if(109===c)a=isFinite(a)?""+a:"null";else if(111===c||108===c)a=""+a;else if(106===c)if(a){var e=(c="[object Array]"===G.prototype.toString.call(a))?"[":"{";if(c)for(var d=0;d<a.length;d++)e+=(0==d?"":",")+B.stringify(a[d]);else for(d in a)a.hasOwnProperty(d)&&(e+=(1==e.length?"":",")+b(d)+":"+B.stringify(a[d]));a=e+(c?"]":"}")}else a="null";else a="void 0";return a}};s=function(a,b,c,e,f){var k=o.document,b=i(b);D=n;if(b.c===i().c&&!f)a&&(r[d.href]=
a);else{A=e;if(c)o.lfirst?(history.back(),s(a,b.a,0,e,1)):d.replace("#"+b.d);else if(b.a!=g||f)o.lfirst||(o.lfirst=1,s(a,g,0,e,1)),k.open(),k.write('<script>lfirst=1;parent.location.hash="'+b.d.replace(/"/g,'\\"')+'";<\/script>'),k.close();!f&&a&&(r[d.href]=a)}};x=function(b,c,d,g){k.apply(this,arguments)||(b===t?t[c]=d:b===f?(f[c]=d,"state"===c&&(t=a(t),e.history=f=a(f))):b[c]=d.get&&d.get());return b};setInterval(function(){var a=i().a;if(a!=g){var b=l.createEventObject();b.oldURL=g;b.newURL=g=
a;b.type="hashchange";M(b)}},100);e.JSON=B}}var l=e.document,J=l.documentElement,E=e.sessionStorage,G=e.Object,B=e.JSON,d=e.location,p=e.history,f=p,N=p.pushState,U=p.replaceState,q=!!N,I="state"in p,C=G.defineProperty,t=x({},"t")?{}:l.createElement("a"),w="",O=e.addEventListener?"addEventListener":(w="on")&&"attachEvent",V=e.removeEventListener?"removeEventListener":"detachEvent",W=e.dispatchEvent?"dispatchEvent":"fireEvent",v=e[O],X=e[V],ba=e[W],m={basepath:"/",redirect:0,type:"/"},F="__historyAPI__",
P=l.createElement("a"),A=d.href,R="",D=n,r={},z={},ea={onhashchange:j,onpopstate:j},Y={redirect:function(a,b){m.basepath=b=b==j?m.basepath:b;m.type=a=a==j?m.type:a;if(e.top==e.self){var c=i(j,n,h).c,f=d.search,g=d.pathname;q?(c!=b&&RegExp("^"+b+"$","i").test(g)&&d.replace(c),RegExp("^"+b+"$","i").test(g+"/")?d.replace(b):RegExp("^"+b,"i").test(g)||d.replace(g.replace(/^\//,b)+f)):g!=b&&d.replace(b+"#"+g.replace(RegExp("^"+b,"i"),a)+f+d.hash)}},pushState:function(a,b,c){N&&N.apply(p,arguments);s(a,
c)},replaceState:function(a,b,c){delete r[d.href];U&&U.apply(p,arguments);s(a,c,h)},location:{set:function(a){e.location=a},get:function(){return q?d:t}},state:{get:function(){return r[d.href]||j}}},L={assign:function(a){0===(""+a).indexOf("#")?s(j,a):d.assign(a)},reload:function(){d.reload()},replace:function(a){0===(""+a).indexOf("#")?s(j,a,h):d.replace(a)},toString:function(){return this.href},href:{get:function(){return i().a}},protocol:j,host:j,hostname:j,port:j,pathname:{get:function(){return i().e}},
search:{get:function(){return i().f}},hash:{set:function(a){s(j,(""+a).replace(/^(#|)/,"#"),n,A)},get:function(){return i().b}}};(function(){var a=l.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){m[b]=(c||("basepath"===b?"/":"")).replace(/^(0|false)$/,"")});da();v(w+"hashchange",M,n);var b=[L,t,ea,e,Y,f];I&&delete Y.state;for(var c=0;c<b.length;c+=2)for(var d in b[c])if(b[c].hasOwnProperty(d))if("function"===
typeof b[c][d])b[c+1][d]=b[c][d];else{a=aa(b[c],d,b[c][d]);if(!x(b[c+1],d,a,function(a,d){if(d===f)e.history=f=b[c+1]=a}))return X(w+"hashchange",M,n),n;b[c+1]===e&&(z[d]=z[d.substr(2)]=[])}m.redirect&&f.redirect();!I&&B&&Z(B);if(!q)l[O](w+"click",ca,n);"complete"===l.readyState?S(h):(!q&&i().c!==m.basepath&&(D=h),v(w+"load",S,n));return h})()&&(f.emulate=!q,e[O]=function(a,b,c){a in z?z[a].push(b):3<arguments.length?v(a,b,c,arguments[3]):v(a,b,c)},e[V]=function(a,b,c){var d=z[a];if(d)for(a=d.length;--a;){if(d[a]===
b){d.splice(a,1);break}}else X(a,b,c)},e[W]=H)})(window);
